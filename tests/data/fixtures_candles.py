import json

import pytest
from hexital import Candle


def load_json_candles() -> list:
    csv_file = open("tests/data/test_candles.json")
    return json.load(csv_file)


@pytest.fixture(name="minimal_candles")
def fixture_minimal_candles():
    candles = [
        Candle(
            open=17213,
            high=2395,
            low=7813,
            close=3615,
            volume=19661,
            indicators={"ATR": 100, "NATR": {"nested": 101}},
            sub_indicators={"SATR": 110, "SSATR": {"nested": 111}},
            timestamp=None,
        ),
        Candle(
            open=1301,
            high=3007,
            low=11626,
            close=19048,
            volume=28909,
            indicators={"ATR": 200, "NATR": {"nested": 201}},
            sub_indicators={"SATR": 210, "SSATR": {"nested": 211}},
            timestamp=None,
        ),
        Candle(
            open=12615,
            high=923,
            low=7318,
            close=1351,
            volume=33765,
            indicators={"ATR": 300, "NATR": {"nested": 301}},
            sub_indicators={"SATR": 310, "SSATR": {"nested": 311}},
            timestamp=None,
        ),
        Candle(
            open=1643,
            high=16229,
            low=17721,
            close=212,
            volume=3281,
            indicators={"ATR": 400, "NATR": {"nested": 401}},
            sub_indicators={"SATR": 410, "SSATR": {"nested": 411}},
            timestamp=None,
        ),
        Candle(
            open=424,
            high=10614,
            low=17133,
            close=7308,
            volume=41793,
            indicators={"ATR": 500, "NATR": {"nested": 501}},
            sub_indicators={"SATR": 510, "SSATR": {"nested": 511}},
            timestamp=None,
        ),
        Candle(
            open=4323,
            high=5858,
            low=8785,
            close=8418,
            volume=34913,
            indicators={"ATR": 600, "NATR": {"nested": 601}},
            sub_indicators={"SATR": 610, "SSATR": {"nested": 611}},
            timestamp=None,
        ),
        Candle(
            open=13838,
            high=13533,
            low=4830,
            close=17765,
            volume=586,
            indicators={"ATR": 700, "NATR": {"nested": 701}},
            sub_indicators={"SATR": 710, "SSATR": {"nested": 711}},
            timestamp=None,
        ),
        Candle(
            open=14373,
            high=18026,
            low=7844,
            close=18798,
            volume=25993,
            indicators={"ATR": 800, "NATR": {"nested": 801}},
            sub_indicators={"SATR": 810, "SSATR": {"nested": 811}},
            timestamp=None,
        ),
        Candle(
            open=12382,
            high=19875,
            low=2853,
            close=1431,
            volume=10055,
            indicators={"ATR": 900, "NATR": {"nested": 901}},
            sub_indicators={"SATR": 910, "SSATR": {"nested": 911}},
            timestamp=None,
        ),
        Candle(
            open=19202,
            high=6584,
            low=6349,
            close=8299,
            volume=13199,
            indicators={"ATR": 1000, "NATR": {"nested": 1001}},
            sub_indicators={"SATR": 1010, "SSATR": {"nested": 1011}},
            timestamp=None,
        ),
        Candle(
            open=19723,
            high=4837,
            low=11631,
            close=6231,
            volume=38993,
            indicators={"ATR": 1100, "NATR": {"nested": 1101}, "MinTR": 1102},
            sub_indicators={"SATR": 1110, "SSATR": {"nested": 1111}},
            timestamp=None,
        ),
        Candle(
            open=13564,
            high=12390,
            low=590,
            close=13416,
            volume=30262,
            indicators={"ATR": 1200, "NATR": {"nested": 1201}, "MinTR": 1202},
            sub_indicators={"SATR": 1210, "SSATR": {"nested": 1211}},
            timestamp=None,
        ),
        Candle(
            open=16319,
            high=5892,
            low=16665,
            close=5776,
            volume=47713,
            indicators={"ATR": 1300, "NATR": {"nested": 1301}, "MinTR": 1302},
            sub_indicators={"SATR": 1310, "SSATR": {"nested": 1311}},
            timestamp=None,
        ),
        Candle(
            open=4709,
            high=8190,
            low=10053,
            close=5062,
            volume=14711,
            indicators={"ATR": 1400, "NATR": {"nested": 1401}, "MinTR": 1402},
            sub_indicators={"SATR": 1410, "SSATR": {"nested": 1411}},
            timestamp=None,
        ),
        Candle(
            open=15803,
            high=5167,
            low=17880,
            close=8916,
            volume=36686,
            indicators={"ATR": 1500, "NATR": {"nested": 1501}, "MinTR": 1502},
            sub_indicators={"SATR": 1510, "SSATR": {"nested": 1511}},
            timestamp=None,
        ),
        Candle(
            open=16425,
            high=1398,
            low=18365,
            close=19637,
            volume=41744,
            indicators={"ATR": 1600, "NATR": {"nested": 1601}, "MinTR": 1602},
            sub_indicators={"SATR": 1610, "SSATR": {"nested": 1611}},
            timestamp=None,
        ),
        Candle(
            open=19535,
            high=3624,
            low=12972,
            close=12862,
            volume=47128,
            indicators={"ATR": 1700, "NATR": {"nested": 1701}, "MinTR": 1702},
            sub_indicators={"SATR": 1710, "SSATR": {"nested": 1711}},
            timestamp=None,
        ),
        Candle(
            open=5837,
            high=11555,
            low=16429,
            close=18501,
            volume=9,
            indicators={"ATR": 1800, "NATR": {"nested": 1801}, "MinTR": 1802},
            sub_indicators={"SATR": 1810, "SSATR": {"nested": 1811}},
            timestamp=None,
        ),
        Candle(
            open=16346,
            high=4309,
            low=1903,
            close=6255,
            volume=31307,
            indicators={"ATR": 1900, "NATR": {"nested": 1901}, "MinTR": 1902},
            sub_indicators={"SATR": 1910, "SSATR": {"nested": 1911}},
            timestamp=None,
        ),
        Candle(
            open=2424,
            high=10767,
            low=13115,
            close=13649,
            volume=15750,
            indicators={"ATR": 2000, "NATR": {"nested": 2001}, "MinTR": 2002},
            sub_indicators={"SATR": 2010, "SSATR": {"nested": 2011}},
            timestamp=None,
        ),
    ]

    return candles


@pytest.fixture(name="candles")
def fixture_candle_data():
    return Candle.from_dicts(load_json_candles())

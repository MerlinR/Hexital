import json

import pytest
from hexital import Candle


def load_json_candles() -> list:
    csv_file = open("tests/data/test_candles.json")
    return json.load(csv_file)


@pytest.fixture(name="minimal_candles")
def fixture_minimal_candles():
    candles = [
        Candle(
            open=17213,
            high=2395,
            low=7813,
            close=3615,
            volume=19661,
            indicators={"ATR": 100},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=1301,
            high=3007,
            low=11626,
            close=19048,
            volume=28909,
            indicators={"ATR": 200},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=12615,
            high=923,
            low=7318,
            close=1351,
            volume=33765,
            indicators={"ATR": 300},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=1643,
            high=16229,
            low=17721,
            close=212,
            volume=3281,
            indicators={"ATR": 400},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=424,
            high=10614,
            low=17133,
            close=7308,
            volume=41793,
            indicators={"ATR": 500},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=4323,
            high=5858,
            low=8785,
            close=8418,
            volume=34913,
            indicators={"ATR": 600},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=13838,
            high=13533,
            low=4830,
            close=17765,
            volume=586,
            indicators={"ATR": 700},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=14373,
            high=18026,
            low=7844,
            close=18798,
            volume=25993,
            indicators={"ATR": 800},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=12382,
            high=19875,
            low=2853,
            close=1431,
            volume=10055,
            indicators={"ATR": 900},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=19202,
            high=6584,
            low=6349,
            close=8299,
            volume=13199,
            indicators={"ATR": 1000},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=19723,
            high=4837,
            low=11631,
            close=6231,
            volume=38993,
            indicators={"ATR": 1100},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=13564,
            high=12390,
            low=590,
            close=13416,
            volume=30262,
            indicators={"ATR": 1200},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=16319,
            high=5892,
            low=16665,
            close=5776,
            volume=47713,
            indicators={"ATR": 1300},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=4709,
            high=8190,
            low=10053,
            close=5062,
            volume=14711,
            indicators={"ATR": 1400},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=15803,
            high=5167,
            low=17880,
            close=8916,
            volume=36686,
            indicators={"ATR": 1500},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=16425,
            high=1398,
            low=18365,
            close=19637,
            volume=41744,
            indicators={"ATR": 1600},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=19535,
            high=3624,
            low=12972,
            close=12862,
            volume=47128,
            indicators={"ATR": 1700},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=5837,
            high=11555,
            low=16429,
            close=18501,
            volume=9,
            indicators={"ATR": 1800},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=16346,
            high=4309,
            low=1903,
            close=6255,
            volume=31307,
            indicators={"ATR": 1900},
            sub_indicators={},
            timestamp=None,
        ),
        Candle(
            open=2424,
            high=10767,
            low=13115,
            close=13649,
            volume=15750,
            indicators={"ATR": 2000},
            sub_indicators={},
            timestamp=None,
        ),
    ]

    return candles


@pytest.fixture(name="candles")
def fixture_candle_data():
    return Candle.from_dicts(load_json_candles())
